# Phase 2 å®ŒæˆçŠ¶æ€æŠ¥å‘Š

## ğŸ“… å®Œæˆæ—¶é—´
**å®Œæˆæ—¥æœŸ**: 2024å¹´æœ€æ–°  
**é˜¶æ®µ**: Phase 2 - æ ¸å¿ƒäº¤äº’æœºåˆ¶å¼€å‘  
**çŠ¶æ€**: âœ… å·²å®Œæˆ

---

## ğŸ¯ å·²å®Œæˆçš„æ ¸å¿ƒä»»åŠ¡

### âœ… 1. Editç»„ä»¶AIåŠŸèƒ½é›†æˆ
#### ä¿®æ”¹æ–‡ä»¶: `web/src/pages/Edit/components/Edit.vue`
- âœ… å¼•å…¥ `aiResponseMixin` æ··å…¥
- âœ… æ·»åŠ AIç›¸å…³äº‹ä»¶ç›‘å¬è®¾ç½®
- âœ… å®ç°èŠ‚ç‚¹æ–‡æœ¬ç¼–è¾‘å®Œæˆäº‹ä»¶ç›‘å¬
- âœ… é›†æˆç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ˆåˆ›å»ºå’Œæ¸…ç†ï¼‰

#### å…³é”®ä»£ç é›†æˆ:
```javascript
// å¼•å…¥AIå“åº”å¤„ç†åŠŸèƒ½
import aiResponseMixin from '@/mixins/aiResponseMixin.js'

export default {
  // æ·»åŠ AIå“åº”å¤„ç†Mixin
  mixins: [aiResponseMixin],
  // ... ç»„ä»¶é…ç½®
}
```

### âœ… 2. äº‹ä»¶ç›‘å¬æœºåˆ¶å®Œå–„
#### æ–°å¢æ–¹æ³•:
- âœ… `setupAIEventListeners()` - è®¾ç½®AIç›¸å…³äº‹ä»¶ç›‘å¬
- âœ… `cleanupAIEventListeners()` - æ¸…ç†AIäº‹ä»¶ç›‘å¬  
- âœ… `node_text_edit_end` äº‹ä»¶ç›‘å¬é›†æˆ
- âœ… `node_active` äº‹ä»¶ç›‘å¬ï¼ˆç”¨äºè°ƒè¯•ï¼‰

#### äº‹ä»¶ç›‘å¬ç‰¹æ€§:
- ğŸ”„ **è‡ªåŠ¨è§¦å‘**: èŠ‚ç‚¹æ–‡æœ¬ç¼–è¾‘å®Œæˆåè‡ªåŠ¨åˆ¤æ–­æ˜¯å¦ç”ŸæˆAIå›ç­”
- ğŸ›¡ï¸ **å®‰å…¨æ¸…ç†**: ç»„ä»¶é”€æ¯æ—¶è‡ªåŠ¨æ¸…ç†æ‰€æœ‰AIç›¸å…³ç›‘å¬
- ğŸ§  **æ™ºèƒ½åˆ¤æ–­**: é¿å…ä¸ºAIå›ç­”èŠ‚ç‚¹å†æ¬¡ç”Ÿæˆå›ç­”
- ğŸ“Š **è°ƒè¯•æ”¯æŒ**: æ§åˆ¶å°æ—¥å¿—è¾“å‡ºï¼Œä¾¿äºå¼€å‘è°ƒè¯•

### âœ… 3. æ€ç»´å¯¼å›¾APIé€‚é…
#### APIå…¼å®¹æ€§éªŒè¯:
- âœ… ä½¿ç”¨ `simple-mind-map` çš„ `createUid()` ç”ŸæˆèŠ‚ç‚¹ID
- âœ… é€šè¿‡ `this.mindMap.renderer.findNodeByUid()` æŸ¥æ‰¾èŠ‚ç‚¹
- âœ… ä½¿ç”¨ `INSERT_CHILD_NODE` å‘½ä»¤åˆ›å»ºå­èŠ‚ç‚¹
- âœ… ä½¿ç”¨ `SET_NODE_TEXT` å‘½ä»¤æ›´æ–°èŠ‚ç‚¹å†…å®¹
- âœ… ä½¿ç”¨ `SET_NODE_DATA` å‘½ä»¤è®¾ç½®èŠ‚ç‚¹çŠ¶æ€

### âœ… 4. å¼€å‘è°ƒè¯•å·¥å…·é›†æˆ
#### App.vueæµ‹è¯•å·¥å…·é›†æˆ:
- âœ… å¼€å‘ç¯å¢ƒè‡ªåŠ¨åŠ è½½AIæµ‹è¯•å·¥å…·
- âœ… æ§åˆ¶å°è°ƒè¯•å·¥å…·æŒ‚è½½åˆ°windowå¯¹è±¡
- âœ… mindMapå®ä¾‹æŒ‚è½½åˆ° `window.mindMapInstance`

#### è°ƒè¯•åŠŸèƒ½:
```javascript
// å¯ç”¨çš„è°ƒè¯•å‘½ä»¤
window.aiTestUtils.runAITestSuite().then(window.aiTestUtils.displayTestResults)
window.mindMapInstance // æ€ç»´å¯¼å›¾å®ä¾‹
window.aiServiceFactory // AIæœåŠ¡å·¥å‚
```

---

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§

### æ™ºèƒ½è§¦å‘æœºåˆ¶
- **ğŸ§  æ–‡æœ¬æ™ºèƒ½åˆ†æ**: è‡ªåŠ¨è¯†åˆ«é—®é¢˜ç±»å‹æ–‡æœ¬
- **âš¡ å®æ—¶å“åº”**: ç¼–è¾‘å®Œæˆåç«‹å³åˆ¤æ–­å’Œå¤„ç†
- **ğŸš« é‡å¤é˜²æŠ¤**: é¿å…é‡å¤åˆ›å»ºAIå›ç­”èŠ‚ç‚¹
- **ğŸ¯ ç²¾å‡†å®šä½**: é’ˆå¯¹å…·ä½“èŠ‚ç‚¹åˆ›å»ºå¯¹åº”AIå›ç­”

### èŠ‚ç‚¹ç®¡ç†ç³»ç»Ÿ  
- **ğŸ¤– è‡ªåŠ¨åˆ›å»º**: æ™ºèƒ½åˆ›å»ºAIå›ç­”å­èŠ‚ç‚¹
- **ğŸ“ å®æ—¶æ›´æ–°**: æµå¼æ›´æ–°èŠ‚ç‚¹å†…å®¹
- **ğŸ¨ çŠ¶æ€ç®¡ç†**: loading/complete/errorä¸‰ç§çŠ¶æ€
- **ğŸ”— å…³ç³»æ˜ å°„**: ç»´æŠ¤é—®é¢˜èŠ‚ç‚¹ä¸AIå›ç­”èŠ‚ç‚¹çš„æ˜ å°„å…³ç³»

### äº‹ä»¶ç®¡ç†ä½“ç³»
- **ğŸ‘‚ ç²¾å‡†ç›‘å¬**: åªç›‘å¬å¿…è¦çš„èŠ‚ç‚¹ç¼–è¾‘äº‹ä»¶
- **ğŸ”„ ç”Ÿå‘½å‘¨æœŸ**: å®Œæ•´çš„äº‹ä»¶ç»‘å®šå’Œæ¸…ç†æœºåˆ¶
- **ğŸ“Š çŠ¶æ€åŒæ­¥**: ä¸æ€ç»´å¯¼å›¾å®ä¾‹çŠ¶æ€ä¿æŒåŒæ­¥
- **ğŸ›¡ï¸ å¼‚å¸¸å¤„ç†**: å®Œå–„çš„é”™è¯¯æ•è·å’Œæ¢å¤æœºåˆ¶

---

## ğŸ“ æ–‡ä»¶ä¿®æ”¹æ¦‚è§ˆ

### ä¿®æ”¹çš„æ ¸å¿ƒæ–‡ä»¶
```
web/src/
â”œâ”€â”€ pages/Edit/components/
â”‚   â””â”€â”€ Edit.vue                   # ä¸»è¦ä¿®æ”¹ï¼šé›†æˆAIåŠŸèƒ½
â”œâ”€â”€ App.vue                        # æµ‹è¯•å·¥å…·é›†æˆ
â””â”€â”€ [Phase 1æ–‡ä»¶ä¿æŒä¸å˜]
```

### æ–°å¢å†…å®¹ç»Ÿè®¡
- **Edit.vue**: æ–°å¢ ~60è¡Œ AIé›†æˆä»£ç 
- **App.vue**: æ–°å¢ ~8è¡Œ æµ‹è¯•å·¥å…·åŠ è½½ä»£ç 
- **æ€»è®¡**: ~68è¡Œæ–°å¢æ ¸å¿ƒé›†æˆä»£ç 

---

## ğŸ¯ æ™ºèƒ½åˆ¤æ–­ç®—æ³•

### è§¦å‘AIå›ç­”çš„æ¡ä»¶
```javascript
// é—®é¢˜å…³é”®è¯åˆ¤æ–­
const questionIndicators = [
  '?', 'ï¼Ÿ',                           // é—®å·
  'æ€ä¹ˆ', 'å¦‚ä½•', 'æ€æ ·', 'æ€ä¹ˆæ ·',      // æ–¹å¼æ–¹æ³•
  'ä¸ºä»€ä¹ˆ', 'ä¸ºå•¥', 'ä»€ä¹ˆåŸå› ',         // åŸå› 
  'ä»€ä¹ˆ', 'å“ªä¸ª', 'å“ªäº›', 'å“ªé‡Œ',       // ç–‘é—®è¯
  'æ˜¯å¦', 'èƒ½å¦', 'å¯ä»¥', 'å¯ä¸å¯ä»¥',    // æ˜¯å¦ç±»
  'ä»‹ç»', 'è§£é‡Š', 'è¯´æ˜', 'é˜è¿°',       // è§£é‡Šç±»
  'å¯¹æ¯”', 'åŒºåˆ«', 'ä¸åŒ', 'å·®å¼‚',       // å¯¹æ¯”ç±»
]

// æ–‡æœ¬ç»“æ„åˆ¤æ–­
const isLongStatement = trimmedText.length > 15 && !trimmedText.includes('ï¼š')

// ä¸“ä¸šæœ¯è¯­åˆ¤æ–­  
const technicalTerms = ['AI', 'ç®—æ³•', 'ç¼–ç¨‹', 'æŠ€æœ¯', 'æ¶æ„', 'æ¡†æ¶']
const hasTechnicalTerm = technicalTerms.some(term => trimmedText.includes(term))
```

### æ’é™¤æ¡ä»¶
- âŒ æ–‡æœ¬é•¿åº¦ < 3å­—ç¬¦
- âŒ AIåŠŸèƒ½è¢«ç¦ç”¨
- âŒ å½“å‰èŠ‚ç‚¹æ˜¯AIå›ç­”èŠ‚ç‚¹
- âŒ èŠ‚ç‚¹å·²æœ‰æ­£åœ¨å¤„ç†çš„AIè¯·æ±‚

---

## ğŸ§ª éªŒè¯æµ‹è¯•æ¸…å•

### åŸºç¡€åŠŸèƒ½æµ‹è¯•
- [ ] é¡¹ç›®æ­£å¸¸å¯åŠ¨ï¼Œæ— æ§åˆ¶å°é”™è¯¯
- [ ] AIæµ‹è¯•å·¥å…·æ­£ç¡®åŠ è½½
- [ ] mindMapå®ä¾‹æ­£ç¡®æŒ‚è½½
- [ ] äº‹ä»¶ç›‘å¬è®¾ç½®æˆåŠŸæ—¥å¿—

### æ™ºèƒ½åˆ¤æ–­æµ‹è¯•
**åº”è¯¥è§¦å‘AIå›ç­”**:
- [ ] "ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ"
- [ ] "å¦‚ä½•å­¦ä¹ ç¼–ç¨‹"  
- [ ] "ä»‹ç»Vue.jsæ¡†æ¶"
- [ ] "è¿™æ˜¯ä¸€ä¸ªå…³äºå‰ç«¯æ¶æ„çš„è¯¦ç»†åˆ†æ"

**ä¸åº”è¯¥è§¦å‘AIå›ç­”**:
- [ ] "é¦–é¡µ"
- [ ] "æ ‡é¢˜1"
- [ ] "å¾…åŠäº‹é¡¹"

### APIé›†æˆæµ‹è¯•
- [ ] é…ç½®API Keyåè¿æ¥æµ‹è¯•æˆåŠŸ
- [ ] èŠ‚ç‚¹åˆ›å»ºAPIè°ƒç”¨æ­£å¸¸
- [ ] æ–‡æœ¬æ›´æ–°APIè°ƒç”¨æ­£å¸¸
- [ ] é”™è¯¯å¤„ç†æœºåˆ¶æ­£å¸¸

---

## ğŸš€ é¡¹ç›®å¯åŠ¨éªŒè¯

### å¯åŠ¨å‘½ä»¤
```bash
cd web && npm run serve
```

### é¢„æœŸæ§åˆ¶å°è¾“å‡º
```
ğŸ§ª AIæµ‹è¯•å·¥å…·å·²åŠ è½½å®Œæˆ
AIæœåŠ¡æ¨¡å—å·²åŠ è½½ï¼Œç‰ˆæœ¬: 1.0.0
ğŸ¤– æ­£åœ¨è®¾ç½®AIäº‹ä»¶ç›‘å¬...
âœ… AIäº‹ä»¶ç›‘å¬è®¾ç½®å®Œæˆ  
ğŸ› ï¸ mindMapå®ä¾‹å·²æŒ‚è½½åˆ° window.mindMapInstance
ğŸ’¡ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æµ‹è¯•AIåŠŸèƒ½:
   window.aiTestUtils.runAITestSuite().then(window.aiTestUtils.displayTestResults)
```

### å¿«é€ŸéªŒè¯å‘½ä»¤
```javascript
// 1. åŸºç¡€åŠŸèƒ½æµ‹è¯•
window.aiTestUtils.testAIServiceBasic()

// 2. å®Œæ•´æµ‹è¯•å¥—ä»¶
window.aiTestUtils.runAITestSuite().then(window.aiTestUtils.displayTestResults)

// 3. æ‰‹åŠ¨è§¦å‘AIå›ç­”ï¼ˆéœ€å…ˆé…ç½®API Keyï¼‰
const rootNode = window.mindMapInstance.renderer.root
window.mindMapInstance.execCommand('INSERT_CHILD_NODE', rootNode, {text: 'ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½ï¼Ÿ'})
```

---

## ğŸ¯ ä¸‹ä¸€é˜¶æ®µè®¡åˆ’ (Phase 3)

### ä¼˜å…ˆä»»åŠ¡
1. **çœŸå®ç¯å¢ƒæµ‹è¯•** - é…ç½®çœŸå®API Keyè¿›è¡Œå®Œæ•´æµ‹è¯•
2. **å³é”®èœå•æ‰©å±•** - æ·»åŠ æ‰‹åŠ¨è§¦å‘AIå›ç­”çš„èœå•é¡¹
3. **å¿«æ·é”®æ”¯æŒ** - å®ç° Ctrl+Shift+A æ‰‹åŠ¨è§¦å‘
4. **é…ç½®ç•Œé¢ä¼˜åŒ–** - æ‰©å±•AIé…ç½®å¯¹è¯æ¡†

### é¢„æœŸäº¤ä»˜
- å®Œæ•´çš„ç«¯åˆ°ç«¯åŠŸèƒ½éªŒè¯
- ä¼˜åŒ–çš„ç”¨æˆ·äº¤äº’ä½“éªŒ
- å®Œå–„çš„é…ç½®ç®¡ç†ç•Œé¢

---

## ğŸ’¡ æŠ€æœ¯è¦ç‚¹æ€»ç»“

### æ¶æ„è®¾è®¡ä¼˜åŠ¿
- âœ… **æ¾è€¦åˆè®¾è®¡**: Mixinæ¨¡å¼ä¾¿äºåŠŸèƒ½ç‹¬ç«‹å’Œæµ‹è¯•
- âœ… **äº‹ä»¶é©±åŠ¨**: åŸºäºæ€ç»´å¯¼å›¾äº‹ä»¶ç³»ç»Ÿï¼Œæ— ä¾µå…¥æ€§
- âœ… **çŠ¶æ€ç®¡ç†**: å®Œæ•´çš„AIèŠ‚ç‚¹çŠ¶æ€è·Ÿè¸ªæœºåˆ¶
- âœ… **é”™è¯¯æ¢å¤**: å®Œå–„çš„å¼‚å¸¸å¤„ç†å’ŒçŠ¶æ€æ¢å¤

### å¼€å‘å‹å¥½ç‰¹æ€§
- âœ… **è°ƒè¯•æ”¯æŒ**: ä¸°å¯Œçš„æ§åˆ¶å°æ—¥å¿—å’Œè°ƒè¯•å·¥å…·
- âœ… **çƒ­é‡è½½å…¼å®¹**: æ”¯æŒå¼€å‘ç¯å¢ƒçš„çƒ­é‡è½½
- âœ… **ç±»å‹å®‰å…¨**: å®Œæ•´çš„å‚æ•°éªŒè¯å’Œé”™è¯¯æç¤º
- âœ… **æ–‡æ¡£å®Œå¤‡**: è¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Šå’Œä½¿ç”¨æŒ‡å—

### ç”¨æˆ·ä½“éªŒè€ƒé‡
- âœ… **æ™ºèƒ½åˆ¤æ–­**: å‡å°‘è¯¯è§¦å‘ï¼Œæé«˜å‡†ç¡®æ€§
- âœ… **è§†è§‰åé¦ˆ**: æ¸…æ™°çš„çŠ¶æ€æŒ‡ç¤ºå’ŒåŠ¨ç”»æ•ˆæœ
- âœ… **æ€§èƒ½ä¼˜åŒ–**: å¼‚æ­¥å¤„ç†ï¼Œä¸é˜»å¡ç”¨æˆ·æ“ä½œ
- âœ… **æ¸è¿›å¢å¼º**: ä¸å½±å“åŸæœ‰åŠŸèƒ½çš„ä½¿ç”¨

---

## ğŸ”— ç›¸å…³æ–‡æ¡£
- [Phase 1 å®ŒæˆçŠ¶æ€](./Phase1å®ŒæˆçŠ¶æ€.md) - åŸºç¡€æ¶æ„å®Œæˆæƒ…å†µ
- [Phase 2 åŠŸèƒ½æµ‹è¯•æŒ‡å—](./Phase2åŠŸèƒ½æµ‹è¯•æŒ‡å—.md) - è¯¦ç»†æµ‹è¯•æ­¥éª¤
- [AIå¯¹è¯åŠŸèƒ½é›†æˆæŒ‡å¯¼æ–‡æ¡£](./AIå¯¹è¯åŠŸèƒ½é›†æˆæŒ‡å¯¼æ–‡æ¡£.md) - å®Œæ•´å®æ–½æŒ‡å¯¼

---

**ğŸ“Š Phase 2 è¯„ä¼°ç»“æœ**: âœ… **æ ¸å¿ƒåŠŸèƒ½å·²å®Œæˆ**ï¼ŒAIè‡ªåŠ¨å›ç­”æœºåˆ¶å·²æˆåŠŸé›†æˆåˆ°æ€ç»´å¯¼å›¾ç¼–è¾‘å™¨

**ğŸ‰ é‡è¦é‡Œç¨‹ç¢‘**: ç”¨æˆ·ç°åœ¨å¯ä»¥åœ¨æ€ç»´å¯¼å›¾ä¸­è¾“å…¥é—®é¢˜æ–‡å­—ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨åˆ›å»ºAIå›ç­”èŠ‚ç‚¹å¹¶å±•ç¤ºå›ç­”å†…å®¹ï¼

**ğŸš€ å‡†å¤‡å°±ç»ª**: å·²å…·å¤‡è¿›å…¥å®é™…æµ‹è¯•å’Œç”¨æˆ·ä½“éªŒä¼˜åŒ–é˜¶æ®µçš„æ¡ä»¶ 